{
  "hash": "87bb55e20b740d4be4eff6acc5dd0665",
  "result": {
    "markdown": "---\ntitle: \"Challenge 2: Data Acquisition\"\nauthor: \"Mohamed, Islam\"\nmatriculation number: \"21650912\"\n---\n\n# Challenge: \n## Get some data via an API.\nFor this part of the challenge, I am using a Translator API from the translator engine Deepl. The user can type a text and in our case it will be translated to any supported language. In the following example, the target language is german. \n\nYou can change the parameter \"target_lang\" in the function translate2 to change the target language to another one. Also, in the parameter \"text\" you can change the written text below to translate a different text. \n\n*Code below*\n\n\n::: {.cell hash='02_data_acquisition_cache/html/unnamed-chunk-1_23a93d0d3f6f275f6cb3d126a3111ddf'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\ninstall.packages(\"devtools\", repos = \"http://cran.rstudio.com/\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Installing package into 'C:/Users/islam/AppData/Local/R/win-library/4.2'\n#> (as 'lib' is unspecified)\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n#> package 'devtools' successfully unpacked and MD5 sums checked\n#> \n#> The downloaded binary packages are in\n#> \tC:\\Users\\islam\\AppData\\Local\\Temp\\RtmpKsRVmV\\downloaded_packages\n```\n:::\n\n```{.r .cell-code}\ndevtools::install_github(\"zumbov2/deeplr\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> WARNING: Rtools is required to build R packages, but no version of Rtools compatible with R 4.2.0 was found. (Only the following incompatible version(s) of Rtools were found: 4.3.5550)\n#> \n#> Please download and install Rtools 4.2 from https://cran.r-project.org/bin/windows/Rtools/ or https://www.r-project.org/nosvn/winutf8/ucrt3/.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Skipping install of 'deeplr' from a github remote, the SHA1 (b9206467) has not changed since last install.\n#>   Use `force = TRUE` to force installation\n```\n:::\n\n```{.r .cell-code}\nmy_auth_key = \"05bc2a53-360f-1d6a-540f-2b880ad44d62:fx\"\ntext_to_be_translated = \"La seule facon de savoir ce qui se passe est de perturber le systeme.\"\n\ntranslated_text <- deeplr::translate2(\n  text = text_to_be_translated,\n  target_lang = \"EN\",\n  auth_key = my_auth_key\n)\nknitr::kable(text_to_be_translated, caption = 'text to be translated')\n```\n\n::: {.cell-output-display}\nTable: text to be translated\n\n|x                                                                     |\n|:---------------------------------------------------------------------|\n|La seule facon de savoir ce qui se passe est de perturber le systeme. |\n:::\n\n```{.r .cell-code}\nknitr::kable(translated_text, caption = 'translated text')\n```\n\n::: {.cell-output-display}\nTable: translated text\n\n|x                                                                   |\n|:-------------------------------------------------------------------|\n|The only way to find out what is going on is to disrupt the system. |\n:::\n:::\n\n\n# Challenge: \n## Scrape one of the competitor websites of canyon\n\n\n::: {.cell hash='02_data_acquisition_cache/html/unnamed-chunk-2_5f493865724655352f94c591d490da41'}\n\n```{.r .cell-code}\nlibrary(RSQLite)\nlibrary(tidyverse)\nlibrary(httr)\nlibrary(glue)\nlibrary(jsonlite)\nlibrary(rvest)\nlibrary(stringi)\nlibrary(xopen)\nlibrary(dplyr)\nbase_url <- 'https://www.rosebikes.com/bikes'\n# 1. Function to get bike family URLs.\nget_bike_family_urls <- function(base_url) {\n  \n  bike_family_urls <- read_html(base_url) %>%\n    html_nodes(css = \".catalog-categories-item > a\") %>%\n    html_attr('href') %>%\n    \n    # Convert vector to tibble\n    \n    enframe(name = \"position\", value = \"subdirectory\") %>%\n    # Add the domain because we will get only the subdirectories\n    mutate(\n      url = glue('https://www.rosebikes.com{subdirectory}')\n    ) \n  \n\n  \n}\n# 2. Function to get bike family URLs.\nget_model_urls <- function(url) {\n  \n  bike_type_url <- read_html(url) %>%\n    html_nodes(css = \".catalog-category-bikes__content > a\") %>%\n    html_attr('href') %>%\n    enframe(name = \"position\", value = \"url\") %>%\n    mutate(url = glue('https://www.rosebikes.com{url}')) \n}\n# 3. Function to get the names of each bike \nget_bike_names <- function(url) {\n  \n  bike_model_name_tbl <- read_html(url) %>%\n    html_nodes(css = \".catalog-category-model__title\") %>%\n    html_text() %>%\n    # Convert vector to tibble\n    as_tibble()\n  \n  \n}\n# 4. Function to get the prices of each bike \nget_bike_prices <- function(url) {\n  \n  bike_model_price_tbl <- read_html(url) %>%\n    html_nodes(css = \".product-tile-price__current-value\") %>%\n    html_text() %>%\n    # Convert vector to tibble\n    as_tibble()\n  \n}\n#### APPLYING ABOVE FUNCTIONS\nbike_family_url_tbl <- get_bike_family_urls(base_url)\nbike_family_url_tbl <- bike_family_url_tbl %>%\n  slice(2:5) # Pick 3 categories\n# Create a table with bike model URLS\nbike_model_url_tbl <- tibble()\nfor (i in seq_along(bike_family_url_tbl$url)) {\n  \n  web <- toString(bike_family_url_tbl$url[i])\n  bike_model_url_tbl <- bind_rows(bike_model_url_tbl, get_model_urls(web))\n  \n}\n# Create a table with bike model names\nbike_model_names_tbl <- tibble()\nfor (i in seq_along(bike_model_url_tbl$url)) {\n  \n  web <- toString(bike_model_url_tbl$url[i])\n  bike_model_names_tbl <- bind_rows(bike_model_names_tbl, get_bike_names(web))\n  \n}\n# Rename cols\nnames(bike_model_names_tbl)[1] <- \"Bike Model\"\n# Create a table with bike prices\nbike_model_prices_tbl <- tibble()\nfor (i in seq_along(bike_model_url_tbl$url)) {\n  web <- toString(bike_model_url_tbl$url[i])\n  bike_model_prices_tbl <- bind_rows(bike_model_prices_tbl, get_bike_prices(web))\n}\n# Rename columns\nnames(bike_model_prices_tbl)[1] <- \"Bike Price\"\n# Visualize scraped data into a table \ntable_of_prices <- bind_cols(bike_model_names_tbl,bike_model_prices_tbl)\nknitr::kable(table_of_prices[1:10, ], caption = 'Rosebike.com bicycle model \"Road\" including prices')\n```\n\n::: {.cell-output-display}\nTable: Rosebike.com bicycle model \"Road\" including prices\n\n|Bike Model              |Bike Price |\n|:-----------------------|:----------|\n|XLITE 04 105            |€2,999.00  |\n|XLITE 04 Ultegra        |€3,299.00  |\n|XLITE 04 105 Di2        |€3,599.00  |\n|XLITE 04 Ultegra Di2    |€4,599.00  |\n|XLITE 04 Force eTap AXS |€4,599.00  |\n|XLITE 04 Force AXS      |€4,999.00  |\n|XLITE 06 Ultegra        |€3,999.00  |\n|XLITE 06 Ultegra Di2    |€5,999.00  |\n|XLITE 06 Force eTap AXS |€5,999.00  |\n|XLITE 06 Force AXS      |€6,499.00  |\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}